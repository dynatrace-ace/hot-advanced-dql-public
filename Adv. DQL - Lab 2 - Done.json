{"version":"6","defaultTimeframe":{"from":"now()-7d","to":"now()"},"sections":[{"id":"8b25be63-5e67-4ad0-b785-8ce12ae03c6d","type":"markdown","markdown":"# Adv. DQL - Lab 2 - **Instructor Copy**\n\n## DQL Repair Shop\n---"},{"id":"f137da53-92f8-47dd-b02a-9ce19bfa8040","type":"markdown","markdown":"### 2.1 Optimise \n\nYou've identified a colleague using a query that seems to be slow and scanning a lot of data. \n\n**Task:**\n- Reduce the scanned bytes of the query\n- Replace inefficient operations with efficient ones to improve execution time\n"},{"id":"70536a78-2fd9-4a90-8cb1-63161e693262","type":"dql","showTitle":false,"filterSegments":[],"drilldownPath":[],"height":67,"state":{"input":{"value":"fetch logs, scanLimitGBytes:-1\n| fieldsAdd parts = splitString(content, \" \")\n| fieldsAdd responseCode = parts[7]\n| sort responseCode desc\n| filter startsWith(dt.process.name,\"nginx hipstershop production\", caseSensitive:false)\n| filter startsWith(log.source, \"container output\", caseSensitive:false)\n| filter contains(responseCode,\"500\")\n| summarize failures = count()\n\n| append [fetch logs, scanLimitGBytes:-1\n| fieldsAdd parts = splitString(content, \" \")\n| fieldsAdd responseCode = parts[7]\n| sort responseCode desc\n| filter startsWith(dt.process.name,\"nginx hipstershop production\", caseSensitive:false)\n| filter startsWith(log.source, \"container output\", caseSensitive:false)\n| filter contains(responseCode,\"200\")\n| summarize success = count()]\n\n| summarize {sum(success), sum(failures)}","timeframe":{"from":"now()-7d","to":"now()"}},"visualization":"table","querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"result":{"code":200,"value":{"records":[{"sum(success)":1804478,"sum(failures)":7313}],"metadata":{"grail":{"canonicalQuery":"fetch logs, scanLimitGBytes:-1\n| fieldsAdd parts = splitString(content, \" \")\n| fieldsAdd responseCode = parts[7]\n| sort responseCode desc\n| filter startsWith(dt.process.name, \"nginx hipstershop production\", caseSensitive:FALSE)\n| filter startsWith(log.source, \"container output\", caseSensitive:FALSE)\n| filter contains(responseCode, \"500\")\n| summarize failures = count()\n| append \n\t[\n\t\tfetch logs, scanLimitGBytes:-1\n\t\t| fieldsAdd parts = splitString(content, \" \")\n\t\t| fieldsAdd responseCode = parts[7]\n\t\t| sort responseCode desc\n\t\t| filter startsWith(dt.process.name, \"nginx hipstershop production\", caseSensitive:FALSE)\n\t\t| filter startsWith(log.source, \"container output\", caseSensitive:FALSE)\n\t\t| filter contains(responseCode, \"200\")\n\t\t| summarize success = count()\n\t]\n| summarize sum(success), sum(failures)","timezone":"Europe/London","query":"fetch logs, scanLimitGBytes:-1\n| fieldsAdd parts = splitString(content, \" \")\n| fieldsAdd responseCode = parts[7]\n| sort responseCode desc\n| filter startsWith(dt.process.name,\"nginx hipstershop production\", caseSensitive:false)\n| filter startsWith(log.source, \"container output\", caseSensitive:false)\n| filter contains(responseCode,\"500\")\n| summarize failures = count()\n\n| append [fetch logs, scanLimitGBytes:-1\n| fieldsAdd parts = splitString(content, \" \")\n| fieldsAdd responseCode = parts[7]\n| sort responseCode desc\n| filter startsWith(dt.process.name,\"nginx hipstershop production\", caseSensitive:false)\n| filter startsWith(log.source, \"container output\", caseSensitive:false)\n| filter contains(responseCode,\"200\")\n| summarize success = count()]\n\n| summarize {sum(success), sum(failures)}","scannedRecords":1483382653,"dqlVersion":"V1_0","scannedBytes":70098112176,"scannedDataPoints":0,"analysisTimeframe":{"start":"2024-12-26T13:09:51.648Z","end":"2025-01-02T13:09:51.648Z"},"locale":"en-US","executionTimeMilliseconds":2580,"notifications":[],"queryId":"c5f340cd-6476-460a-8903-0c27143d6f89","sampled":false}},"types":[{"mappings":{"sum(success)":{"type":"double"},"sum(failures)":{"type":"double"}},"indexRange":[0,0]}]},"notifications":[],"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"dateTime":"2025-01-02T13:09:56.528Z","input":{"timeframe":{"from":"now()-7d","to":"now()"},"value":"fetch logs, scanLimitGBytes:-1\n| fieldsAdd parts = splitString(content, \" \")\n| fieldsAdd responseCode = parts[7]\n| sort responseCode desc\n| filter startsWith(dt.process.name,\"nginx hipstershop production\", caseSensitive:false)\n| filter startsWith(log.source, \"container output\", caseSensitive:false)\n| filter contains(responseCode,\"500\")\n| summarize failures = count()\n\n| append [fetch logs, scanLimitGBytes:-1\n| fieldsAdd parts = splitString(content, \" \")\n| fieldsAdd responseCode = parts[7]\n| sort responseCode desc\n| filter startsWith(dt.process.name,\"nginx hipstershop production\", caseSensitive:false)\n| filter startsWith(log.source, \"container output\", caseSensitive:false)\n| filter contains(responseCode,\"200\")\n| summarize success = count()]\n\n| summarize {sum(success), sum(failures)}"}},"visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"vertical","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","categoryAxisLabel":"sum(success),sum(failures)","valueAxisLabel":"sum(success),sum(failures)","tooltipVariant":"single","categoryAxis":["sum(success)","sum(failures)"],"valueAxis":["sum(success)","sum(failures)"]},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle"},"singleValue":{"showLabel":true,"label":"timestamp","prefixIcon":"","recordField":"timestamp","autoscale":true,"alignment":"center","trend":{"trendType":"auto","isVisible":true},"colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"firstVisibleRowIndex":0,"columnWidths":{"[\"content\"]":883.9479370117188,"[\"parts\"]":1341},"columnTypeOverrides":[{"fields":["content"],"id":1729253817950,"value":"log-content"}]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"displayedFields":[],"dataMappings":{},"truncationMode":"middle","colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"sum(success)","rangeAxis":""},{"valueAxis":"sum(failures)","rangeAxis":""}],"variant":"single","truncationMode":"middle","displayedFields":[]}},"state":"success"},"previousFilterSegments":[]},{"id":"f6bbf186-a7e1-4091-a73e-1bfbcea2c583","type":"markdown","markdown":"#### Midpoint optimised data but not fully optimised for execution time\n---"},{"id":"a8085f13-ec1a-4c82-872d-d2c6fa374261","type":"dql","showTitle":false,"filterSegments":[],"drilldownPath":[],"height":65,"showInput":false,"state":{"input":{"value":"fetch logs, scanLimitGBytes:-1\n| filter startsWith(dt.process.name,\"nginx hipstershop production\", caseSensitive:false)\n| filter startsWith(log.source, \"container output\", caseSensitive:false)\n| fieldsAdd parts = splitString(content, \" \")\n| fieldsAdd responseCode = parts[7]\n| sort responseCode desc\n\n| summarize {successes = countIf(responseCode == \"200\"), failures = countIf(responseCode == \"500\")}","timeframe":{"from":"now()-7d","to":"now()"}},"visualization":"table","querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"result":{"code":200,"value":{"records":[{"successes":"1804456","failures":"7313"}],"metadata":{"grail":{"canonicalQuery":"fetch logs, scanLimitGBytes:-1\n| filter startsWith(dt.process.name, \"nginx hipstershop production\", caseSensitive:FALSE)\n| filter startsWith(log.source, \"container output\", caseSensitive:FALSE)\n| fieldsAdd parts = splitString(content, \" \")\n| fieldsAdd responseCode = parts[7]\n| sort responseCode desc\n| summarize successes = countIf(responseCode == \"200\"), failures = countIf(responseCode == \"500\")","timezone":"Europe/London","query":"fetch logs, scanLimitGBytes:-1\n| filter startsWith(dt.process.name,\"nginx hipstershop production\", caseSensitive:false)\n| filter startsWith(log.source, \"container output\", caseSensitive:false)\n| fieldsAdd parts = splitString(content, \" \")\n| fieldsAdd responseCode = parts[7]\n| sort responseCode desc\n\n| summarize {successes = countIf(responseCode == \"200\"), failures = countIf(responseCode == \"500\")}","scannedRecords":741416389,"dqlVersion":"V1_0","scannedBytes":35049058042,"scannedDataPoints":0,"analysisTimeframe":{"start":"2024-12-26T13:09:57.489Z","end":"2025-01-02T13:09:57.489Z"},"locale":"en-US","executionTimeMilliseconds":647,"notifications":[],"queryId":"12bc5e19-4a38-4eea-8048-0f3c5888258e","sampled":false}},"types":[{"mappings":{"successes":{"type":"long"},"failures":{"type":"long"}},"indexRange":[0,0]}]},"notifications":[],"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"dateTime":"2025-01-02T13:09:58.981Z","input":{"timeframe":{"from":"now()-7d","to":"now()"},"value":"fetch logs, scanLimitGBytes:-1\n| filter startsWith(dt.process.name,\"nginx hipstershop production\", caseSensitive:false)\n| filter startsWith(log.source, \"container output\", caseSensitive:false)\n| fieldsAdd parts = splitString(content, \" \")\n| fieldsAdd responseCode = parts[7]\n| sort responseCode desc\n\n| summarize {successes = countIf(responseCode == \"200\"), failures = countIf(responseCode == \"500\")}"}},"visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"vertical","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","categoryAxis":["successes","failures"],"categoryAxisLabel":"successes,failures","valueAxis":["successes","failures"],"valueAxisLabel":"successes,failures","tooltipVariant":"single"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle"},"singleValue":{"showLabel":true,"label":"successes","prefixIcon":"","recordField":"successes","autoscale":true,"alignment":"center","trend":{"trendType":"auto","isVisible":true},"colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"firstVisibleRowIndex":0,"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"displayedFields":[],"dataMappings":{},"truncationMode":"middle","colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"successes","rangeAxis":""},{"valueAxis":"failures","rangeAxis":""}],"variant":"single","truncationMode":"middle","displayedFields":[]}},"state":"success"},"previousFilterSegments":[]},{"id":"4e9c42cb-bfcd-4f09-b1ab-2105125335ba","type":"markdown","markdown":"#### Fully Optimised\n--- \n "},{"id":"ad172de4-521e-4c3a-883d-b21b3ff084e2","type":"dql","showTitle":false,"filterSegments":[],"drilldownPath":[],"height":68,"showInput":true,"state":{"input":{"value":"fetch logs\n| filter dt.process.name == \"nginx hipstershop production\"\n| fieldsAdd responseCode = splitString(content, \" \")[7]\n| summarize {successes = countIf(responseCode == \"200\"), failures = countIf(responseCode == \"500\")}","timeframe":{"from":"now()-7d","to":"now()"}},"visualization":"table","querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"result":{"value":{"records":[{"successes":"1804439","failures":"7312"}],"metadata":{"grail":{"canonicalQuery":"fetch logs\n| filter dt.process.name == \"nginx hipstershop production\"\n| fieldsAdd responseCode = splitString(content, \" \")[7]\n| summarize successes = countIf(responseCode == \"200\"), failures = countIf(responseCode == \"500\")","timezone":"Europe/London","query":"fetch logs\n| filter dt.process.name == \"nginx hipstershop production\"\n| fieldsAdd responseCode = splitString(content, \" \")[7]\n| summarize {successes = countIf(responseCode == \"200\"), failures = countIf(responseCode == \"500\")}","scannedRecords":741974645,"dqlVersion":"V1_0","scannedBytes":35049399194,"scannedDataPoints":0,"analysisTimeframe":{"start":"2024-12-26T13:10:01.185Z","end":"2025-01-02T13:10:01.185Z"},"locale":"en-US","executionTimeMilliseconds":170,"notifications":[],"queryId":"7c9ca4a1-89cb-49b6-bc1e-9528cb260d3a","sampled":false}},"types":[{"mappings":{"successes":{"type":"long"},"failures":{"type":"long"}},"indexRange":[0,0]}]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"code":200,"notifications":[],"dateTime":"2025-01-02T13:10:02.673Z","input":{"timeframe":{"from":"now()-7d","to":"now()"},"value":"fetch logs\n| filter dt.process.name == \"nginx hipstershop production\"\n| fieldsAdd responseCode = splitString(content, \" \")[7]\n| summarize {successes = countIf(responseCode == \"200\"), failures = countIf(responseCode == \"500\")}"}},"visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"vertical","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","categoryAxisLabel":"successes,failures","valueAxisLabel":"successes,failures","tooltipVariant":"single","categoryAxis":["successes","failures"],"valueAxis":["successes","failures"]},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle"},"singleValue":{"showLabel":true,"label":"error","prefixIcon":"","recordField":"error","autoscale":true,"alignment":"center","trend":{"trendType":"auto","isVisible":true},"colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"firstVisibleRowIndex":0,"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"displayedFields":[],"dataMappings":{},"truncationMode":"middle","colorMode":"color-palette","colorPalette":"blue"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"successes","rangeAxis":""},{"valueAxis":"failures","rangeAxis":""}],"variant":"single","truncationMode":"middle","displayedFields":[]}},"state":"success"},"previousFilterSegments":[]},{"id":"99805a21-778f-4dc9-90ba-a9c548cd66b7","type":"markdown","markdown":"### 2.2 Fix the broken DQL\n\nAnother colleague has asked for help. They found some bits of DQL used by the colleagues but they can't get it to work.\n\n**Task:**\n- Reorder and fix issues in DQL\n"},{"id":"31e1a4ba-642a-4df5-999b-176724aef9c8","type":"dql","showTitle":false,"filterSegments":[],"drilldownPath":[],"state":{"input":{"value":"fetch dt.entity.process_group_instance\n| fields entity.name, dt.entity.host=runs_on[dt.entity.host],\n  dt.entity.process_group= instance_of[dt.entity.process_group],\n  dt.entity.process_group_instance = id\n\n| lookup sourceField:dt.entity.host, lookupField:dt.entity.host, [fetch bizevents\n  | filter event.type==\"carbon.measurement\"\n  | summarize sum = sum(carbon.emissions), by:{dt.entity.host}]\n| filter isNotNull(lookup.sum)\n\n| lookup [timeseries ts=avg(dt.process.cpu.usage), \n  by:{dt.entity.process_group_instance}\n  | fields cpu_sum= arraySum(ts), dt.entity.process_group_instance],sourceField:dt.entity.process_group_instance, \n  lookupField:id\n| fieldsAdd cpu_sum=lookup.cpu_sum\n\n| fieldsRename carbon_per_host=carbon.sum\n| fieldsRemove \"lookup*\"\n\n| lookup [timeseries ts=avg(dt.process.cpu.usage),  by:{dt.entity.process_group_instance}\n  | lookup [fetch dt.entity.process_group_instance], sourceField:dt.entity.process_group_instance, lookupField:id\n  | fields ts, dt.entity.process_group_instance, dt.entity.host = lookup.belongs_to[dt.entity.host]\n  | lookup [fetch dt.entity.process_group_instance], sourceField:dt.entity.process_group_instance, lookupField:id\n  | fieldsAdd cpusum = arraySum(ts)\n  | summarize cpuHostSum = toString(sum(cpusum)), by:{dt.entity.host}],\n  sourceField:dt.entity.host, lookupField:dt.entity.host\n\n  \n| fieldsAdd carbon_per_process = (if(isNull(cpu_sum),0,else:cpu_sum)/lookup.cpuHostSum) * carbon_per_host\n\n| fields dt.entity.host,dt.entity.process_group, dt.entity.process_group_instance, \n  dt.entity.process_group_instance.name = entity.name, carbon_per_process\n| sort carbon_per_process desc \n| limit 100","timeframe":{"from":"now()-7d","to":"now()"}},"visualization":"recordView","querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"result":{"code":400,"error":"In the target, there is no field id.","notifications":[],"dateTime":"2024-10-18T13:12:02.996Z","input":{"timeframe":{"from":"now()-7d","to":"now()"},"value":"fetch dt.entity.process_group_instance\n| fields entity.name, dt.entity.host=runs_on[dt.entity.host],\n  dt.entity.process_group= instance_of[dt.entity.process_group],\n  dt.entity.process_group_instance = id\n\n| lookup sourceField:dt.entity.host, lookupField:dt.entity.host, [fetch bizevents\n  | filter event.type==\"carbon.measurement\"\n  | summarize sum = sum(carbon.emissions), by:{dt.entity.host}]\n| filter isNotNull(lookup.sum)\n\n| lookup [timeseries ts=avg(dt.process.cpu.usage), \n  by:{dt.entity.process_group_instance}\n  | fields cpu_sum= arraySum(ts), dt.entity.process_group_instance],sourceField:dt.entity.process_group_instance, \n  lookupField:id\n| fieldsAdd cpu_sum=lookup.cpu_sum\n\n| fieldsRename carbon_per_host=carbon.sum\n| fieldsRemove \"lookup*\"\n\n| lookup [timeseries ts=avg(dt.process.cpu.usage),  by:{dt.entity.process_group_instance}\n  | lookup [fetch dt.entity.process_group_instance], sourceField:dt.entity.process_group_instance, lookupField:id\n  | fields ts, dt.entity.process_group_instance, dt.entity.host = lookup.belongs_to[dt.entity.host]\n  | lookup [fetch dt.entity.process_group_instance], sourceField:dt.entity.process_group_instance, lookupField:id\n  | fieldsAdd cpusum = arraySum(ts)\n  | summarize cpuHostSum = toString(sum(cpusum)), by:{dt.entity.host}],\n  sourceField:dt.entity.host, lookupField:dt.entity.host\n\n  \n| fieldsAdd carbon_per_process = (if(isNull(cpu_sum),0,else:cpu_sum)/lookup.cpuHostSum) * carbon_per_host\n\n| fields dt.entity.host,dt.entity.process_group, dt.entity.process_group_instance, \n  dt.entity.process_group_instance.name = entity.name, carbon_per_process\n| sort carbon_per_process desc \n| limit 100"},"value":{"error":{"message":"JOIN_TARGET_FIELD_DOES_NOT_EXIST","details":{"exceptionType":"DQL-RESULT_TYPE","syntaxErrorPosition":{"start":{"column":15,"index":650,"line":14},"end":{"column":16,"index":651,"line":14}},"errorType":"JOIN_TARGET_FIELD_DOES_NOT_EXIST","errorMessage":"In the target, there is no field id.","arguments":["id"],"queryString":"fetch dt.entity.process_group_instance\n| fields entity.name, dt.entity.host=runs_on[dt.entity.host],\n  dt.entity.process_group= instance_of[dt.entity.process_group],\n  dt.entity.process_group_instance = id\n\n| lookup sourceField:dt.entity.host, lookupField:dt.entity.host, [fetch bizevents\n  | filter event.type==\"carbon.measurement\"\n  | summarize sum = sum(carbon.emissions), by:{dt.entity.host}]\n| filter isNotNull(lookup.sum)\n\n| lookup [timeseries ts=avg(dt.process.cpu.usage), \n  by:{dt.entity.process_group_instance}\n  | fields cpu_sum= arraySum(ts), dt.entity.process_group_instance],sourceField:dt.entity.process_group_instance, \n  lookupField:id\n| fieldsAdd cpu_sum=lookup.cpu_sum\n\n| fieldsRename carbon_per_host=carbon.sum\n| fieldsRemove \"lookup*\"\n\n| lookup [timeseries ts=avg(dt.process.cpu.usage),  by:{dt.entity.process_group_instance}\n  | lookup [fetch dt.entity.process_group_instance], sourceField:dt.entity.process_group_instance, lookupField:id\n  | fields ts, dt.entity.process_group_instance, dt.entity.host = lookup.belongs_to[dt.entity.host]\n  | lookup [fetch dt.entity.process_group_instance], sourceField:dt.entity.process_group_instance, lookupField:id\n  | fieldsAdd cpusum = arraySum(ts)\n  | summarize cpuHostSum = toString(sum(cpusum)), by:{dt.entity.host}],\n  sourceField:dt.entity.host, lookupField:dt.entity.host\n\n  \n| fieldsAdd carbon_per_process = (if(isNull(cpu_sum),0,else:cpu_sum)/lookup.cpuHostSum) * carbon_per_host\n\n| fields dt.entity.host,dt.entity.process_group, dt.entity.process_group_instance, \n  dt.entity.process_group_instance.name = entity.name, carbon_per_process\n| sort carbon_per_process desc \n| limit 100","errorMessageFormatSpecifierTypes":["FIELD_NAME"],"errorMessageFormat":"In the target, there is no field %1$s.","queryId":"e1563e49-7bdf-4fe5-9d9d-71bf07531607"},"code":400}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"vertical","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","categoryAxisLabel":"dt.entity.process_group_instance.name","valueAxisLabel":"carbon_per_process","tooltipVariant":"single"},"colorPalette":"categorical","xAxisScaling":"analyzedTimeframe","truncationMode":"middle"},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","recordField":"dt.entity.host","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"firstVisibleRowIndex":0,"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"blue","dataMappings":{},"displayedFields":[]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[]}},"state":"error"}},{"id":"1a9eae1c-4aa7-496b-8116-f7aeeb4100b6","type":"markdown","markdown":"#### Broken with Comments\n--- \n "},{"id":"eacf52bc-8692-4229-adf2-b4e730d3f7a2","type":"dql","showTitle":false,"filterSegments":[],"state":{"input":{"value":"fetch dt.entity.process_group_instance\n| fields entity.name, dt.entity.host=runs_on[dt.entity.host], // Fix relationship, should be belongs_to\n  dt.entity.process_group= instance_of[dt.entity.process_group],\n  dt.entity.process_group_instance = id\n\n| lookup sourceField:dt.entity.host, lookupField:dt.entity.host, [fetch bizevents\n  | filter event.type==\"carbon.measurement\"\n  | summarize sum = sum(carbon.emissions), by:{dt.entity.host}] // Add a prefix otherwise it'll be overwritten below\n| filter isNotNull(lookup.sum) // Change to prefix name\n\n| lookup [timeseries ts=avg(dt.process.cpu.usage), \n  by:{dt.entity.process_group_instance}\n  | fields cpu_sum= arraySum(ts), dt.entity.process_group_instance],sourceField:dt.entity.process_group_instance, \n  lookupField:id // Fix fieldname should be dt.entity.process_group_instance as per the split by\n| fieldsAdd cpu_sum=lookup.cpu_sum\n\n| fieldsRename carbon_per_host=carbon.sum\n| fieldsRemove \"lookup*\"\n\n| lookup [timeseries ts=avg(dt.process.cpu.usage),  by:{dt.entity.process_group_instance}\n  | lookup [fetch dt.entity.process_group_instance], sourceField:dt.entity.process_group_instance, lookupField:id\n  | fields ts, dt.entity.process_group_instance, dt.entity.host = lookup.belongs_to[dt.entity.host]\n  | lookup [fetch dt.entity.process_group_instance], sourceField:dt.entity.process_group_instance, lookupField:id\n  | fieldsAdd cpusum = arraySum(ts)\n  | summarize cpuHostSum = toString(sum(cpusum)), by:{dt.entity.host}], // Remove the toString() as it will break the maths later\n  sourceField:dt.entity.host, lookupField:dt.entity.host\n\n  \n| fieldsAdd carbon_per_process = (if(isNull(cpu_sum),0,else:cpu_sum)/lookup.cpuHostSum) * carbon_per_host\n\n| fields dt.entity.host,dt.entity.process_group, dt.entity.process_group_instance, \n  dt.entity.process_group_instance.name = entity.name, carbon_per_process\n| sort carbon_per_process desc \n| limit 100","timeframe":{"from":"now()-7d","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"state":"idle","visualizationSettings":{}}},{"id":"c9eddf4b-15f6-4faf-a3e2-64e29a2ecc52","type":"markdown","markdown":"#### Fixed with Comments\n--- \n "},{"id":"a64cddc5-3b6c-484c-b00c-11ffafce1ed5","type":"dql","showTitle":false,"filterSegments":[],"drilldownPath":[],"showInput":false,"state":{"input":{"value":"fetch dt.entity.process_group_instance\n| fields entity.name, dt.entity.host=belongs_to[dt.entity.host], // Fix relationship, should be belongs_to\n  dt.entity.process_group= instance_of[dt.entity.process_group],\n  dt.entity.process_group_instance = id\n\n| lookup sourceField:dt.entity.host, lookupField:dt.entity.host, [fetch bizevents\n  | filter event.type==\"carbon.measurement\"\n  | summarize sum = sum(carbon.emissions), by:{dt.entity.host}], prefix:\"carbon.\" // Add a prefix otherwise it'll be overwritten below\n| filter isNotNull(carbon.sum) // Change to prefix name\n\n| lookup [timeseries ts=avg(dt.process.cpu.usage), \n  by:{dt.entity.process_group_instance}\n  | fields cpu_sum= arraySum(ts), dt.entity.process_group_instance],sourceField:dt.entity.process_group_instance, \n  lookupField:dt.entity.process_group_instance // Fix fieldname should be dt.entity.process_group_instance as per the split by\n| fieldsAdd cpu_sum=lookup.cpu_sum\n\n| fieldsRename carbon_per_host=carbon.sum\n| fieldsRemove \"lookup*\"\n\n| lookup [timeseries ts=avg(dt.process.cpu.usage),  by:{dt.entity.process_group_instance}\n  | lookup [fetch dt.entity.process_group_instance], sourceField:dt.entity.process_group_instance, lookupField:id\n  | fields ts, dt.entity.process_group_instance, dt.entity.host = lookup.belongs_to[dt.entity.host]\n  | lookup [fetch dt.entity.process_group_instance], sourceField:dt.entity.process_group_instance, lookupField:id\n  | fieldsAdd cpusum = arraySum(ts)\n  | summarize cpuHostSum =sum(cpusum), by:{dt.entity.host}], // Remove the toString() as it will break the maths later\n  sourceField:dt.entity.host, lookupField:dt.entity.host\n\n  \n| fieldsAdd carbon_per_process = (if(isNull(cpu_sum),0,else:cpu_sum)/lookup.cpuHostSum) * carbon_per_host\n\n| fields dt.entity.host,dt.entity.process_group, dt.entity.process_group_instance, \n  dt.entity.process_group_instance.name = entity.name, carbon_per_process\n| sort carbon_per_process desc \n| limit 100","timeframe":{"from":"now()-7d","to":"now()"}},"visualization":"recordView","querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"result":{"value":{"records":[{"dt.entity.host":"HOST-273EF88BEFED7C70","dt.entity.process_group":"PROCESS_GROUP-F3C0415BFFAC18F2","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-4787F6086EF8CD7A","dt.entity.process_group_instance.name":"chrome loadgen-* loadgen (loadgen-665744f867-gjh6l)","carbon_per_process":1298.1301390915676},{"dt.entity.host":"HOST-5143BFBC3C40AC2D","dt.entity.process_group":"PROCESS_GROUP-4ABD7B91085E4F42","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-92D61FEFBC77D54A","dt.entity.process_group_instance.name":"chrome my-otel-demo-loadgenerator-* loadgenerator (my-otel-demo-loadgenerator-867c949bd7-b5bsn)","carbon_per_process":1143.3378578853967},{"dt.entity.host":"HOST-A0D0407E9F620807","dt.entity.process_group":"PROCESS_GROUP-7C1B10C91BA3C61E","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-1C6A9DDD43D65344","dt.entity.process_group_instance.name":"server.js (frontend) my-otel-demo-frontend-* (my-otel-demo-frontend-65c644ffdf-ntvsq)","carbon_per_process":600.7739385126611},{"dt.entity.host":"HOST-5143BFBC3C40AC2D","dt.entity.process_group":"PROCESS_GROUP-651A22F97BF5B060","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-CE991D75434A4897","dt.entity.process_group_instance.name":"locust my-otel-demo-loadgenerator-* (my-otel-demo-loadgenerator-867c949bd7-b5bsn)","carbon_per_process":202.5348511505406},{"dt.entity.host":"HOST-CDD2F9BB85A2DA68","dt.entity.process_group":"PROCESS_GROUP-FCCBB6846037939D","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-31194F3FE59549F5","dt.entity.process_group_instance.name":"eT-google-cloud-demo-BusinessBackend","carbon_per_process":193.7169206914864},{"dt.entity.host":"HOST-5143BFBC3C40AC2D","dt.entity.process_group":"PROCESS_GROUP-1EC945A15C28CC8D","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-2EABAF2C7EF68770","dt.entity.process_group_instance.name":"lib/cli/cli.js (playwright-core) my-otel-demo-loadgenerator-* (my-otel-demo-loadgenerator-867c949bd7-b5bsn)","carbon_per_process":170.66647067656447},{"dt.entity.host":"HOST-CDD2F9BB85A2DA68","dt.entity.process_group":"PROCESS_GROUP-FB370CE4DE93E385","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-36E5F55F5B3139ED","dt.entity.process_group_instance.name":"easytravel-*-x*","carbon_per_process":115.38033958941638},{"dt.entity.host":"HOST-B63426FD95D1B9EC","dt.entity.process_group":"PROCESS_GROUP-D128573FFA47F819","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-FBA9BAAC4648B07F","dt.entity.process_group_instance.name":"kafka.docker.KafkaDockerWrapper my-otel-demo-kafka-* (my-otel-demo-kafka-6678c45b5c-6x588)","carbon_per_process":108.79995817153879},{"dt.entity.host":"HOST-B63426FD95D1B9EC","dt.entity.process_group":"PROCESS_GROUP-00A559340CFD5356","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-88ABDA243011B3E4","dt.entity.process_group_instance.name":"locust unguard-malicious-load-generator-* (unguard-malicious-load-generator-7b57d55fbd-lcf52)","carbon_per_process":107.36410888992697},{"dt.entity.host":"HOST-A0D0407E9F620807","dt.entity.process_group":"PROCESS_GROUP-9898642B3BD38179","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-ACB3CB41647D7B05","dt.entity.process_group_instance.name":"easyTradeManager.dll easytrade production (manager-c5b4c94b8-dbwqx)","carbon_per_process":103.89627601633588},{"dt.entity.host":"HOST-B63426FD95D1B9EC","dt.entity.process_group":"PROCESS_GROUP-8A0DF0F9C446635C","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-0B12419FC3F4D020","dt.entity.process_group_instance.name":"containerd-shim-runc-v*","carbon_per_process":86.37215990063814},{"dt.entity.host":"HOST-273EF88BEFED7C70","dt.entity.process_group":"PROCESS_GROUP-D2539DA235171358","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-5EFFC7DAD3B57927","dt.entity.process_group_instance.name":"chrome loadgen-* loadgen (loadgen-665744f867-gjh6l)","carbon_per_process":81.0355868781497},{"dt.entity.host":"HOST-A0D0407E9F620807","dt.entity.process_group":"PROCESS_GROUP-40C8F41D337A023C","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-53A847D92C0CD4D0","dt.entity.process_group_instance.name":"kubelet","carbon_per_process":64.75858392789355},{"dt.entity.host":"HOST-A0D0407E9F620807","dt.entity.process_group":"PROCESS_GROUP-8A0DF0F9C446635C","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-1DF6271CC94761CB","dt.entity.process_group_instance.name":"containerd-shim-runc-v*","carbon_per_process":59.71331461099695},{"dt.entity.host":"HOST-273EF88BEFED7C70","dt.entity.process_group":"PROCESS_GROUP-21E48F885ACCF22A","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-D25BC85720E49ACC","dt.entity.process_group_instance.name":"build/src/main.js (easytrade-load-generator) easytrade production (loadgen-665744f867-gjh6l)","carbon_per_process":50.95662897524899},{"dt.entity.host":"HOST-A0D0407E9F620807","dt.entity.process_group":"PROCESS_GROUP-570474ADCAC391E1","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-1FE8799210BE35F0","dt.entity.process_group_instance.name":"MSSQL db-* db (db-6f857c55bf-r7j5f)","carbon_per_process":44.966434070653506},{"dt.entity.host":"HOST-B63426FD95D1B9EC","dt.entity.process_group":"PROCESS_GROUP-40C8F41D337A023C","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-454C215A26BF653B","dt.entity.process_group_instance.name":"kubelet","carbon_per_process":39.22175104423127},{"dt.entity.host":"HOST-A0D0407E9F620807","dt.entity.process_group":"PROCESS_GROUP-963EF202D17A5983","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-746C1A03BEA99AA8","dt.entity.process_group_instance.name":"OneAgent system monitoring eks-oneagent dynatrace-oneagent (eks-oneagent-httf8)","carbon_per_process":38.76012931659262},{"dt.entity.host":"HOST-B63426FD95D1B9EC","dt.entity.process_group":"PROCESS_GROUP-D5A0902970FA1E06","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-6275713B70D523A3","dt.entity.process_group_instance.name":"otelcol-contrib my-otel-demo-otelcol-* (my-otel-demo-otelcol-7cb964855d-sd2p9)","carbon_per_process":36.72779082604271},{"dt.entity.host":"HOST-B63426FD95D1B9EC","dt.entity.process_group":"PROCESS_GROUP-216FDBEF8325B5C6","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-54FD26B0E89BD983","dt.entity.process_group_instance.name":"OneAgent log analytics","carbon_per_process":36.7076923101916},{"dt.entity.host":"HOST-5143BFBC3C40AC2D","dt.entity.process_group":"PROCESS_GROUP-F40008ED2C15DB11","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-C52EB60136C8C32D","dt.entity.process_group_instance.name":"envoy my-otel-demo-frontendproxy-* (my-otel-demo-frontendproxy-fbb8588cf-c8s2m)","carbon_per_process":35.331885630128106},{"dt.entity.host":"HOST-5143BFBC3C40AC2D","dt.entity.process_group":"PROCESS_GROUP-45D53D9875696982","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-EEFB90D97E8E1EA5","dt.entity.process_group_instance.name":"Dynatrace ActiveGate (eks-activegate-0)","carbon_per_process":34.39954945590432},{"dt.entity.host":"HOST-5143BFBC3C40AC2D","dt.entity.process_group":"PROCESS_GROUP-963EF202D17A5983","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-C2F50652E4AB2594","dt.entity.process_group_instance.name":"OneAgent system monitoring eks-oneagent dynatrace-oneagent (eks-oneagent-vgrxn)","carbon_per_process":33.719493298304144},{"dt.entity.host":"HOST-273EF88BEFED7C70","dt.entity.process_group":"PROCESS_GROUP-8A0DF0F9C446635C","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-9A189FE9B9C815BC","dt.entity.process_group_instance.name":"containerd-shim-runc-v*","carbon_per_process":33.45226836139685},{"dt.entity.host":"HOST-B63426FD95D1B9EC","dt.entity.process_group":"PROCESS_GROUP-963EF202D17A5983","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-631D7B3DCA1E0996","dt.entity.process_group_instance.name":"OneAgent system monitoring eks-oneagent dynatrace-oneagent (eks-oneagent-vs2rk)","carbon_per_process":32.59434399273418},{"dt.entity.host":"HOST-A0D0407E9F620807","dt.entity.process_group":"PROCESS_GROUP-34DBAE4A9D5B87C2","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-DFEBE5F52D3C9ECB","dt.entity.process_group_instance.name":"cartservice hipstershop production (cartservice-5bd745f46c-245d5)","carbon_per_process":30.92173517903662},{"dt.entity.host":"HOST-5143BFBC3C40AC2D","dt.entity.process_group":"PROCESS_GROUP-40C8F41D337A023C","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-A23BB81B8F2E70FA","dt.entity.process_group_instance.name":"kubelet","carbon_per_process":25.116983331199666},{"dt.entity.host":"HOST-5143BFBC3C40AC2D","dt.entity.process_group":"PROCESS_GROUP-8A0DF0F9C446635C","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-EC65D8DE6A65C5E1","dt.entity.process_group_instance.name":"containerd-shim-runc-v*","carbon_per_process":24.445940769097295},{"dt.entity.host":"HOST-A0D0407E9F620807","dt.entity.process_group":"PROCESS_GROUP-A9E84EBB6665A1E2","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-7B88FB76BB9D093D","dt.entity.process_group_instance.name":"easyTradeLoginService.dll easytrade production (loginservice-58769c9dd4-4552t)","carbon_per_process":23.795354169491393},{"dt.entity.host":"HOST-A0D0407E9F620807","dt.entity.process_group":"PROCESS_GROUP-F7289ADCF4B60E83","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-122332552F3B037D","dt.entity.process_group_instance.name":"PHP-CLI unguard-like-service-* (unguard-like-service-5c8c796fcb-98rxl)","carbon_per_process":23.19373352165425},{"dt.entity.host":"HOST-273EF88BEFED7C70","dt.entity.process_group":"PROCESS_GROUP-963EF202D17A5983","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-2BA6B85AD38A0D85","dt.entity.process_group_instance.name":"OneAgent system monitoring eks-oneagent dynatrace-oneagent (eks-oneagent-hpfcf)","carbon_per_process":23.176239297946204},{"dt.entity.host":"HOST-CDD2F9BB85A2DA68","dt.entity.process_group":"PROCESS_GROUP-56E787462B747A29","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-CB694A3E19666FED","dt.entity.process_group_instance.name":"OneAgent system monitoring","carbon_per_process":23.09110522782571},{"dt.entity.host":"HOST-A0D0407E9F620807","dt.entity.process_group":"PROCESS_GROUP-6E3C7893419B9306","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-B8B161CE04592790","dt.entity.process_group_instance.name":"CoreDNS coredns-* (coredns-79989457d9-8zrhf)","carbon_per_process":21.65495005502542},{"dt.entity.host":"HOST-A0D0407E9F620807","dt.entity.process_group":"PROCESS_GROUP-2E209D190CCEF89A","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-CA1D46996CAFC0B4","dt.entity.process_group_instance.name":"SpringBoot com.dynatrace.easytrade.accountservice.AccountServiceApplic easytrade production (accountservice-699bb7d884-n7l9p)","carbon_per_process":21.096584365905297},{"dt.entity.host":"HOST-273EF88BEFED7C70","dt.entity.process_group":"PROCESS_GROUP-40C8F41D337A023C","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-D446FF2C5C83A0A7","dt.entity.process_group_instance.name":"kubelet","carbon_per_process":20.765154400689656},{"dt.entity.host":"HOST-5143BFBC3C40AC2D","dt.entity.process_group":"PROCESS_GROUP-29D6ED8F2BBB1ABD","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-CCDD3B67959291B0","dt.entity.process_group_instance.name":"nginx easytrade production (frontendreverseproxy-dc875f8fb-5xf6n)","carbon_per_process":20.44545413340364},{"dt.entity.host":"HOST-CDD2F9BB85A2DA68","dt.entity.process_group":"PROCESS_GROUP-6E318F50F3AB1543","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-A3E376EB7609CF2B","dt.entity.process_group_instance.name":"com.dynatrace.easytravel.cmdlauncher.jar easytravel-*-x*","carbon_per_process":20.360867977432047},{"dt.entity.host":"HOST-A0D0407E9F620807","dt.entity.process_group":"PROCESS_GROUP-06E7C568BB61C6D4","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-1976B5BE3F936E18","dt.entity.process_group_instance.name":"OneAgent network monitoring eks-oneagent dynatrace-oneagent (eks-oneagent-httf8)","carbon_per_process":17.574326393121215},{"dt.entity.host":"HOST-5143BFBC3C40AC2D","dt.entity.process_group":"PROCESS_GROUP-849A7F4F60BD107C","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-1521B45D32F26A65","dt.entity.process_group_instance.name":"recommendation_server.py my-otel-demo-recommendationservice-* (my-otel-demo-recommendationservice-9f4496497-72hs8)","carbon_per_process":16.715531455031584},{"dt.entity.host":"HOST-A0D0407E9F620807","dt.entity.process_group":"PROCESS_GROUP-0E654D040B91D2A5","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-CBDA340A891265B8","dt.entity.process_group_instance.name":"bin/www (user-auth-service) unguard-user-auth-service-* (unguard-user-auth-service-d6c6cccdb-jwcb2)","carbon_per_process":16.53509577702352},{"dt.entity.host":"HOST-CDD2F9BB85A2DA68","dt.entity.process_group":"PROCESS_GROUP-7554DCF6D1B61BAD","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-8F4613ED6DD052D1","dt.entity.process_group_instance.name":"OneAgent network monitoring","carbon_per_process":15.095640906187137},{"dt.entity.host":"HOST-B63426FD95D1B9EC","dt.entity.process_group":"PROCESS_GROUP-E12353EB56894D8D","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-CBA2BE78EA8605EB","dt.entity.process_group_instance.name":"kafka.Kafka my-otel-demo-kafka-* (my-otel-demo-kafka-6678c45b5c-6x588)","carbon_per_process":14.409601336941847},{"dt.entity.host":"HOST-A0D0407E9F620807","dt.entity.process_group":"PROCESS_GROUP-64979A479CD1923F","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-9AEF3539B132E67C","dt.entity.process_group_instance.name":"SpringBoot com.dynatrace.easytrade.featureflagservice.Featureflagservi easytrade production (feature-flag-service-58d6457947-qtj4c)","carbon_per_process":14.200095247450221},{"dt.entity.host":"HOST-A0D0407E9F620807","dt.entity.process_group":"PROCESS_GROUP-BF10C9CB69F3BCAD","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-C2E1370643A7D4BB","dt.entity.process_group_instance.name":"MembershipService.dll unguard-membership-service-* (unguard-membership-service-c4978bcd-8dd67)","carbon_per_process":13.76849828683694},{"dt.entity.host":"HOST-273EF88BEFED7C70","dt.entity.process_group":"PROCESS_GROUP-89F4E82A9105281A","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-0B6D788E5BD369C6","dt.entity.process_group_instance.name":"src/app.js (easytrade_offer_service) easytrade production (offerservice-75cb55459f-zzjvt)","carbon_per_process":13.759838293876083},{"dt.entity.host":"HOST-A0D0407E9F620807","dt.entity.process_group":"PROCESS_GROUP-711202FB9AD12DF5","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-81A8BD0561CA82DF","dt.entity.process_group_instance.name":"productcatalogservice my-otel-demo-productcatalogservice-* (my-otel-demo-productcatalogservice-6f4b457bfd-82t4v)","carbon_per_process":13.591752972199131},{"dt.entity.host":"HOST-5143BFBC3C40AC2D","dt.entity.process_group":"PROCESS_GROUP-B9A875B675166422","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-853F8A4A4839BC5B","dt.entity.process_group_instance.name":"BrokerService.dll easytrade production (broker-service-85fcf4fdb5-l6t4k)","carbon_per_process":12.836803109902052},{"dt.entity.host":"HOST-5143BFBC3C40AC2D","dt.entity.process_group":"PROCESS_GROUP-B9A875B675166422","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-DBE51D6002E5BC29","dt.entity.process_group_instance.name":"BrokerService.dll easytrade production (broker-service-85fcf4fdb5-h5qvv)","carbon_per_process":12.796297916166326},{"dt.entity.host":"HOST-A0D0407E9F620807","dt.entity.process_group":"PROCESS_GROUP-628E1D4CAD1B41B9","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-5C195772DFA78E9F","dt.entity.process_group_instance.name":"Apache Web Server apache* hipstershop production (shippingholidaysservice-6d96c9ddd9-xkqj8)","carbon_per_process":12.718804282420859},{"dt.entity.host":"HOST-5143BFBC3C40AC2D","dt.entity.process_group":"PROCESS_GROUP-B9A875B675166422","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-CB7930BE2FAF2D2D","dt.entity.process_group_instance.name":"BrokerService.dll easytrade production (broker-service-85fcf4fdb5-2gs9q)","carbon_per_process":12.314226427497108},{"dt.entity.host":"HOST-5143BFBC3C40AC2D","dt.entity.process_group":"PROCESS_GROUP-B9A875B675166422","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-E5728EBD492565EE","dt.entity.process_group_instance.name":"BrokerService.dll easytrade production (broker-service-85fcf4fdb5-8665s)","carbon_per_process":12.054612874012676},{"dt.entity.host":"HOST-A0D0407E9F620807","dt.entity.process_group":"PROCESS_GROUP-1C2B481FDBBEA5D6","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-ECF5F1734FADD3D4","dt.entity.process_group_instance.name":"index.js (paymentservice) hipstershop production (paymentservice-686f65c98d-4pfxg)","carbon_per_process":11.981319448446756},{"dt.entity.host":"HOST-5143BFBC3C40AC2D","dt.entity.process_group":"PROCESS_GROUP-B9A875B675166422","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-60FACA7E0F0BE410","dt.entity.process_group_instance.name":"BrokerService.dll easytrade production (broker-service-85fcf4fdb5-7j46p)","carbon_per_process":11.238761713547335},{"dt.entity.host":"HOST-A0D0407E9F620807","dt.entity.process_group":"PROCESS_GROUP-44CE76E61C654C58","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-F70E7D052503E2C1","dt.entity.process_group_instance.name":"RabbitMQ rabbitmq-* rabbitmq (rabbitmq-5c5b6656df-67k5w)","carbon_per_process":11.12587192632966},{"dt.entity.host":"HOST-B63426FD95D1B9EC","dt.entity.process_group":"PROCESS_GROUP-B9A875B675166422","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-9E4DD682E05A43A8","dt.entity.process_group_instance.name":"BrokerService.dll easytrade production (broker-service-85fcf4fdb5-467bg)","carbon_per_process":10.901749900241642},{"dt.entity.host":"HOST-5143BFBC3C40AC2D","dt.entity.process_group":"PROCESS_GROUP-EF1E81586EB8EDD6","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-B48E11D12844BF3B","dt.entity.process_group_instance.name":"Linux System","carbon_per_process":10.427739415029007},{"dt.entity.host":"HOST-273EF88BEFED7C70","dt.entity.process_group":"PROCESS_GROUP-FAFF2B148223E961","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-34DD4AABFABD7D9F","dt.entity.process_group_instance.name":"server hipstershop production (frontend-74c47dcddb-lm9n8)","carbon_per_process":10.028891785436556},{"dt.entity.host":"HOST-5143BFBC3C40AC2D","dt.entity.process_group":"PROCESS_GROUP-8E913F7E70695213","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-6B5C1AA663D4F65F","dt.entity.process_group_instance.name":"app.js (frontend) unguard-frontend-* (unguard-frontend-579db96496-f75lv)","carbon_per_process":9.742220697360722},{"dt.entity.host":"HOST-A0D0407E9F620807","dt.entity.process_group":"PROCESS_GROUP-5B51EC730D7CC387","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-983F87B4D9BEA75F","dt.entity.process_group_instance.name":"SpringBoot com.dynatrace.easytrade.creditcardorderservice.Application easytrade production (credit-card-order-service-76d7c5449f-nvxtj)","carbon_per_process":9.391039687343948},{"dt.entity.host":"HOST-A0D0407E9F620807","dt.entity.process_group":"PROCESS_GROUP-216FDBEF8325B5C6","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-42194033E2286868","dt.entity.process_group_instance.name":"OneAgent log analytics","carbon_per_process":9.253304910679443},{"dt.entity.host":"HOST-B63426FD95D1B9EC","dt.entity.process_group":"PROCESS_GROUP-3A1B4CBA688C26A9","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-E6A1EE8B56E11743","dt.entity.process_group_instance.name":"cartservice my-otel-demo-cartservice-* cartservice (my-otel-demo-cartservice-6bfc654788-l64ft)","carbon_per_process":9.099931947636385},{"dt.entity.host":"HOST-5143BFBC3C40AC2D","dt.entity.process_group":"PROCESS_GROUP-06E7C568BB61C6D4","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-321CFD322EA93DA3","dt.entity.process_group_instance.name":"OneAgent network monitoring eks-oneagent dynatrace-oneagent (eks-oneagent-vgrxn)","carbon_per_process":9.099632980775178},{"dt.entity.host":"HOST-B63426FD95D1B9EC","dt.entity.process_group":"PROCESS_GROUP-6E3C7893419B9306","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-32E7D0577FC50DA1","dt.entity.process_group_instance.name":"CoreDNS coredns-* (coredns-79989457d9-hfdrw)","carbon_per_process":9.001370534203202},{"dt.entity.host":"HOST-A0D0407E9F620807","dt.entity.process_group":"PROCESS_GROUP-EF1E81586EB8EDD6","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-A884928A8E4E526A","dt.entity.process_group_instance.name":"Linux System","carbon_per_process":8.044904254618952},{"dt.entity.host":"HOST-B63426FD95D1B9EC","dt.entity.process_group":"PROCESS_GROUP-06E7C568BB61C6D4","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-CD5FAAC179706C44","dt.entity.process_group_instance.name":"OneAgent network monitoring eks-oneagent dynatrace-oneagent (eks-oneagent-vs2rk)","carbon_per_process":7.923469079435151},{"dt.entity.host":"HOST-273EF88BEFED7C70","dt.entity.process_group":"PROCESS_GROUP-ECE82357AF59AF52","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-720765B5510CCCAA","dt.entity.process_group_instance.name":"Short-lived processes","carbon_per_process":7.794009599181105},{"dt.entity.host":"HOST-5143BFBC3C40AC2D","dt.entity.process_group":"PROCESS_GROUP-B9A875B675166422","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-7128D28C7DC882AA","dt.entity.process_group_instance.name":"BrokerService.dll easytrade production (broker-service-85fcf4fdb5-zw59f)","carbon_per_process":7.039722727262079},{"dt.entity.host":"HOST-A0D0407E9F620807","dt.entity.process_group":"PROCESS_GROUP-BBA447EB9F94E231","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-B4AFAF6E73DB4D96","dt.entity.process_group_instance.name":"SpringBoot com.dynatrace.easytrade.engine.EngineApplication easytrade production (engine-85948d57c8-mc62s)","carbon_per_process":6.848185435364397},{"dt.entity.host":"HOST-273EF88BEFED7C70","dt.entity.process_group":"PROCESS_GROUP-EF1E81586EB8EDD6","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-C41569470ECECD38","dt.entity.process_group_instance.name":"Linux System","carbon_per_process":6.754863658295445},{"dt.entity.host":"HOST-B63426FD95D1B9EC","dt.entity.process_group":"PROCESS_GROUP-EF1E81586EB8EDD6","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-917A388913C29115","dt.entity.process_group_instance.name":"Linux System","carbon_per_process":6.581580459929424},{"dt.entity.host":"HOST-A0D0407E9F620807","dt.entity.process_group":"PROCESS_GROUP-2263F93108F68023","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-7BB2EA77A6D155DA","dt.entity.process_group_instance.name":"aggregator-service easytrade production (aggregator-service-6dfdd5d6d6-w2xt4)","carbon_per_process":6.370988533020132},{"dt.entity.host":"HOST-B63426FD95D1B9EC","dt.entity.process_group":"PROCESS_GROUP-ECE82357AF59AF52","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-FDFEB594C39FF360","dt.entity.process_group_instance.name":"Short-lived processes","carbon_per_process":6.119838479112356},{"dt.entity.host":"HOST-B63426FD95D1B9EC","dt.entity.process_group":"PROCESS_GROUP-A43F5617864F82DF","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-006908A396E1CCD8","dt.entity.process_group_instance.name":"currencyservice my-otel-demo-currencyservice-* currencyservice (my-otel-demo-currencyservice-cfd644bbf-hcljk)","carbon_per_process":5.970328110211604},{"dt.entity.host":"HOST-CDD2F9BB85A2DA68","dt.entity.process_group":"PROCESS_GROUP-F7B6C02C28735EAD","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-F9C2E23553BE516C","dt.entity.process_group_instance.name":"OneAgent log analytics","carbon_per_process":5.910454238464403},{"dt.entity.host":"HOST-CDD2F9BB85A2DA68","dt.entity.process_group":"PROCESS_GROUP-5502B306D20C4C86","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-D8FB2CCEB1E0E637","dt.entity.process_group_instance.name":"systemd-journald","carbon_per_process":5.585584619078154},{"dt.entity.host":"HOST-273EF88BEFED7C70","dt.entity.process_group":"PROCESS_GROUP-62DA92364D291173","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-09E511AA182C4894","dt.entity.process_group_instance.name":"pricing-service easytrade production (pricing-service-5c7df56d54-jwsx9)","carbon_per_process":5.380516597362657},{"dt.entity.host":"HOST-5143BFBC3C40AC2D","dt.entity.process_group":"PROCESS_GROUP-216FDBEF8325B5C6","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-B38ABFF1410ACC42","dt.entity.process_group_instance.name":"OneAgent log analytics","carbon_per_process":5.335072028405026},{"dt.entity.host":"HOST-5143BFBC3C40AC2D","dt.entity.process_group":"PROCESS_GROUP-B9A875B675166422","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-B96F7BB30BFAAB19","dt.entity.process_group_instance.name":"BrokerService.dll easytrade production (broker-service-85fcf4fdb5-7skmg)","carbon_per_process":5.312311079228662},{"dt.entity.host":"HOST-A0D0407E9F620807","dt.entity.process_group":"PROCESS_GROUP-3EFD27B4F988A137","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-0D67E8905A4D80B2","dt.entity.process_group_instance.name":"app k*s-ephemeral-storage-metrics (k8s-ephemeral-storage-metrics-wfs8d)","carbon_per_process":5.155799393073972},{"dt.entity.host":"HOST-B63426FD95D1B9EC","dt.entity.process_group":"PROCESS_GROUP-CE709B82C9F1DAF4","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-BE324BED2630CA1D","dt.entity.process_group_instance.name":"index.js (paymentservice) my-otel-demo-paymentservice-* (my-otel-demo-paymentservice-69fb7df989-mnfwd)","carbon_per_process":5.063357818205228},{"dt.entity.host":"HOST-5143BFBC3C40AC2D","dt.entity.process_group":"PROCESS_GROUP-7D78F87A8042F051","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-5FB786CCDAEC9596","dt.entity.process_group_instance.name":"flagd-build my-otel-demo-flagd-* (my-otel-demo-flagd-5b7c6d5797-hzvsf)","carbon_per_process":4.851306716127022},{"dt.entity.host":"HOST-273EF88BEFED7C70","dt.entity.process_group":"PROCESS_GROUP-216FDBEF8325B5C6","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-C5F7F8C692A71C1F","dt.entity.process_group_instance.name":"OneAgent log analytics","carbon_per_process":4.677157508560756},{"dt.entity.host":"HOST-5143BFBC3C40AC2D","dt.entity.process_group":"PROCESS_GROUP-3589E83EB66D588B","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-C90CC542A507CE05","dt.entity.process_group_instance.name":"AdService.dll unguard-ad-service-* (unguard-ad-service-5c4c649d84-8lghz)","carbon_per_process":4.440488761649547},{"dt.entity.host":"HOST-273EF88BEFED7C70","dt.entity.process_group":"PROCESS_GROUP-D052EF618E5DAB43","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-B0662CE340DCFB0D","dt.entity.process_group_instance.name":"server.js (grpc-currency-service) hipstershop production (currencyservice-846db7745d-wbbh4)","carbon_per_process":4.260636977531348},{"dt.entity.host":"HOST-A0D0407E9F620807","dt.entity.process_group":"PROCESS_GROUP-5CD3B41931EA8009","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-3426F55BEFB076E6","dt.entity.process_group_instance.name":"flask hipstershop production (translationservice-fb448944c-q26p5)","carbon_per_process":4.2518365840542},{"dt.entity.host":"HOST-B63426FD95D1B9EC","dt.entity.process_group":"PROCESS_GROUP-E731128A9E598579","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-B392BC15E3389A95","dt.entity.process_group_instance.name":"oteldemo.AdService my-otel-demo-adservice-* (my-otel-demo-adservice-6f4f57766f-nq8bj)","carbon_per_process":4.0051439136988005},{"dt.entity.host":"HOST-B63426FD95D1B9EC","dt.entity.process_group":"PROCESS_GROUP-C946E7B66C90E64F","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-83A3A35E22E444EE","dt.entity.process_group_instance.name":"Redis redis-cart-* redis (redis-cart-769d9d57ff-lm6xq)","carbon_per_process":3.8610045927784062},{"dt.entity.host":"HOST-B63426FD95D1B9EC","dt.entity.process_group":"PROCESS_GROUP-3CFF734D19260C33","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-EA9685BB7107350C","dt.entity.process_group_instance.name":"dist/bin/element.js (@flood/element-cli) unguard-user-simulator-* (unguard-user-simulator-28860087-jxd78)","carbon_per_process":3.836202876519346},{"dt.entity.host":"HOST-B63426FD95D1B9EC","dt.entity.process_group":"PROCESS_GROUP-3CFF734D19260C33","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-E1424F49CE98294E","dt.entity.process_group_instance.name":"dist/bin/element.js (@flood/element-cli) unguard-user-simulator-* (unguard-user-simulator-28837596-lmzvz)","carbon_per_process":3.7809162360050257},{"dt.entity.host":"HOST-273EF88BEFED7C70","dt.entity.process_group":"PROCESS_GROUP-06E7C568BB61C6D4","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-5D65DE39823FD97A","dt.entity.process_group_instance.name":"OneAgent network monitoring eks-oneagent dynatrace-oneagent (eks-oneagent-hpfcf)","carbon_per_process":3.7298864550033635},{"dt.entity.host":"HOST-B63426FD95D1B9EC","dt.entity.process_group":"PROCESS_GROUP-3CFF734D19260C33","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-0191029F3E154C13","dt.entity.process_group_instance.name":"dist/bin/element.js (@flood/element-cli) unguard-user-simulator-* (unguard-user-simulator-28906557-2d25m)","carbon_per_process":3.7251387569743453},{"dt.entity.host":"HOST-B63426FD95D1B9EC","dt.entity.process_group":"PROCESS_GROUP-0EB06F14B6FE513B","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-78B6E1375E069B4E","dt.entity.process_group_instance.name":"nginx hipstershop production (frontendreverseproxy-7c46b44d78-cx4r9)","carbon_per_process":3.709432024623985},{"dt.entity.host":"HOST-B63426FD95D1B9EC","dt.entity.process_group":"PROCESS_GROUP-3CFF734D19260C33","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-C6F8111D6068B18C","dt.entity.process_group_instance.name":"dist/bin/element.js (@flood/element-cli) unguard-user-simulator-* (unguard-user-simulator-28780242-9thzh)","carbon_per_process":3.7009975070855647},{"dt.entity.host":"HOST-B63426FD95D1B9EC","dt.entity.process_group":"PROCESS_GROUP-3CFF734D19260C33","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-50D4F6A4C8793A72","dt.entity.process_group_instance.name":"dist/bin/element.js (@flood/element-cli) unguard-user-simulator-* (unguard-user-simulator-28891608-8b9z6)","carbon_per_process":3.676059011199617},{"dt.entity.host":"HOST-B63426FD95D1B9EC","dt.entity.process_group":"PROCESS_GROUP-3CFF734D19260C33","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-781906CE72501177","dt.entity.process_group_instance.name":"dist/bin/element.js (@flood/element-cli) unguard-user-simulator-* (unguard-user-simulator-28768008-j2zch)","carbon_per_process":3.655285735796824},{"dt.entity.host":"HOST-B63426FD95D1B9EC","dt.entity.process_group":"PROCESS_GROUP-3CFF734D19260C33","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-A2376D8690E79E4A","dt.entity.process_group_instance.name":"dist/bin/element.js (@flood/element-cli) unguard-user-simulator-* (unguard-user-simulator-28776213-fk5hn)","carbon_per_process":3.5993900640051035},{"dt.entity.host":"HOST-5143BFBC3C40AC2D","dt.entity.process_group":"PROCESS_GROUP-0F8A5FF4ECBD3F43","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-D013D409A3F670DA","dt.entity.process_group_instance.name":"dist/bin/next (next) my-otel-demo-flagd-* (my-otel-demo-flagd-5b7c6d5797-hzvsf)","carbon_per_process":3.31072779314264},{"dt.entity.host":"HOST-B63426FD95D1B9EC","dt.entity.process_group":"PROCESS_GROUP-203D7D30DBC5E1DA","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-60AD07AB4E2D6011","dt.entity.process_group_instance.name":"SpringBoot org.dynatrace.profileservice.ProfileServiceApplication unguard-profile-service-* (unguard-profile-service-6b88b767df-m8hl2)","carbon_per_process":3.235314582063878},{"dt.entity.host":"HOST-5143BFBC3C40AC2D","dt.entity.process_group":"PROCESS_GROUP-799AAE10AFED6D1E","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-442187AC6DC895F5","dt.entity.process_group_instance.name":"anomaly-simulation-service anomaly-simulation-* (anomaly-simulation-5f7df65b98-tt4cs)","carbon_per_process":2.869414925433246},{"dt.entity.host":"HOST-273EF88BEFED7C70","dt.entity.process_group":"PROCESS_GROUP-5FD398A1C0EA6C92","dt.entity.process_group_instance":"PROCESS_GROUP_INSTANCE-CDFC7BA01EFEADBC","dt.entity.process_group_instance.name":"frauddetectionservice-*-all.jar my-otel-demo-frauddetectionservice-* (my-otel-demo-frauddetectionservice-6895d4c998-5c5d4)","carbon_per_process":2.845539088649065}],"metadata":{"grail":{"canonicalQuery":"fetch dt.entity.process_group_instance\n| fields entity.name, dt.entity.host = belongs_to[dt.entity.host], dt.entity.process_group = instance_of[dt.entity.process_group], dt.entity.process_group_instance = id\n| lookup \n\t[\n\t\tfetch bizevents\n\t\t| filter event.type == \"carbon.measurement\"\n\t\t| summarize by:{dt.entity.host}, sum = sum(carbon.emissions)\n\t], sourceField:dt.entity.host, lookupField:dt.entity.host, prefix:\"carbon.\"\n| filter isNotNull(carbon.sum)\n| lookup \n\t[\n\t\ttimeseries by:{dt.entity.process_group_instance}, ts = avg(dt.process.cpu.usage)\n\t\t| fields cpu_sum = arraySum(ts), dt.entity.process_group_instance\n\t], sourceField:dt.entity.process_group_instance, lookupField:dt.entity.process_group_instance\n| fieldsAdd cpu_sum = lookup.cpu_sum\n| fieldsRename carbon_per_host = carbon.sum\n| fieldsRemove \"lookup*\"\n| lookup \n\t[\n\t\ttimeseries by:{dt.entity.process_group_instance}, ts = avg(dt.process.cpu.usage)\n\t\t| lookup [fetch dt.entity.process_group_instance], sourceField:dt.entity.process_group_instance, lookupField:id\n\t\t| fields ts, dt.entity.process_group_instance, dt.entity.host = lookup.belongs_to[dt.entity.host]\n\t\t| lookup [fetch dt.entity.process_group_instance], sourceField:dt.entity.process_group_instance, lookupField:id\n\t\t| fieldsAdd cpusum = arraySum(ts)\n\t\t| summarize by:{dt.entity.host}, cpuHostSum = sum(cpusum)\n\t], sourceField:dt.entity.host, lookupField:dt.entity.host\n| fieldsAdd carbon_per_process = if(isNull(cpu_sum), 0, else:cpu_sum) / lookup.cpuHostSum * carbon_per_host\n| fields dt.entity.host, dt.entity.process_group, dt.entity.process_group_instance, dt.entity.process_group_instance.name = entity.name, carbon_per_process\n| sort carbon_per_process desc\n| limit 100","timezone":"Europe/London","query":"fetch dt.entity.process_group_instance\n| fields entity.name, dt.entity.host=belongs_to[dt.entity.host], // Fix relationship, should be belongs_to\n  dt.entity.process_group= instance_of[dt.entity.process_group],\n  dt.entity.process_group_instance = id\n\n| lookup sourceField:dt.entity.host, lookupField:dt.entity.host, [fetch bizevents\n  | filter event.type==\"carbon.measurement\"\n  | summarize sum = sum(carbon.emissions), by:{dt.entity.host}], prefix:\"carbon.\" // Add a prefix otherwise it'll be overwritten below\n| filter isNotNull(carbon.sum) // Change to prefix name\n\n| lookup [timeseries ts=avg(dt.process.cpu.usage), \n  by:{dt.entity.process_group_instance}\n  | fields cpu_sum= arraySum(ts), dt.entity.process_group_instance],sourceField:dt.entity.process_group_instance, \n  lookupField:dt.entity.process_group_instance // Fix fieldname should be dt.entity.process_group_instance as per the split by\n| fieldsAdd cpu_sum=lookup.cpu_sum\n\n| fieldsRename carbon_per_host=carbon.sum\n| fieldsRemove \"lookup*\"\n\n| lookup [timeseries ts=avg(dt.process.cpu.usage),  by:{dt.entity.process_group_instance}\n  | lookup [fetch dt.entity.process_group_instance], sourceField:dt.entity.process_group_instance, lookupField:id\n  | fields ts, dt.entity.process_group_instance, dt.entity.host = lookup.belongs_to[dt.entity.host]\n  | lookup [fetch dt.entity.process_group_instance], sourceField:dt.entity.process_group_instance, lookupField:id\n  | fieldsAdd cpusum = arraySum(ts)\n  | summarize cpuHostSum =sum(cpusum), by:{dt.entity.host}], // Remove the toString() as it will break the maths later\n  sourceField:dt.entity.host, lookupField:dt.entity.host\n\n  \n| fieldsAdd carbon_per_process = (if(isNull(cpu_sum),0,else:cpu_sum)/lookup.cpuHostSum) * carbon_per_host\n\n| fields dt.entity.host,dt.entity.process_group, dt.entity.process_group_instance, \n  dt.entity.process_group_instance.name = entity.name, carbon_per_process\n| sort carbon_per_process desc \n| limit 100","scannedRecords":7709670,"dqlVersion":"V1_0","scannedBytes":131671114,"scannedDataPoints":7060916,"analysisTimeframe":{"start":"2024-12-26T13:00:00.000Z","end":"2025-01-02T14:00:00.000Z"},"locale":"en-US","executionTimeMilliseconds":5245,"notifications":[],"queryId":"2891157e-7e18-4d18-96b7-ecd43119c7ec","sampled":false},"metrics":[{"metric.key":"dt.process.cpu.usage","displayName":"Process CPU usage","description":"This metric is the percentage of the CPU usage of a process. The metric value is the sum of CPU time every process worker uses divided by the total available CPU time. The result is expressed in percentage. A value of 100% indicates that the process uses all available CPU resources of the host.","unit":"%","fieldName":"ts"}]},"types":[{"mappings":{"dt.entity.host":{"type":"string"},"dt.entity.process_group":{"type":"string"},"dt.entity.process_group_instance":{"type":"string"},"dt.entity.process_group_instance.name":{"type":"string"},"carbon_per_process":{"type":"double"}},"indexRange":[0,99]}]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"code":200,"notifications":[],"dateTime":"2025-01-02T13:10:15.943Z","input":{"timeframe":{"from":"now()-7d","to":"now()"},"value":"fetch dt.entity.process_group_instance\n| fields entity.name, dt.entity.host=belongs_to[dt.entity.host], // Fix relationship, should be belongs_to\n  dt.entity.process_group= instance_of[dt.entity.process_group],\n  dt.entity.process_group_instance = id\n\n| lookup sourceField:dt.entity.host, lookupField:dt.entity.host, [fetch bizevents\n  | filter event.type==\"carbon.measurement\"\n  | summarize sum = sum(carbon.emissions), by:{dt.entity.host}], prefix:\"carbon.\" // Add a prefix otherwise it'll be overwritten below\n| filter isNotNull(carbon.sum) // Change to prefix name\n\n| lookup [timeseries ts=avg(dt.process.cpu.usage), \n  by:{dt.entity.process_group_instance}\n  | fields cpu_sum= arraySum(ts), dt.entity.process_group_instance],sourceField:dt.entity.process_group_instance, \n  lookupField:dt.entity.process_group_instance // Fix fieldname should be dt.entity.process_group_instance as per the split by\n| fieldsAdd cpu_sum=lookup.cpu_sum\n\n| fieldsRename carbon_per_host=carbon.sum\n| fieldsRemove \"lookup*\"\n\n| lookup [timeseries ts=avg(dt.process.cpu.usage),  by:{dt.entity.process_group_instance}\n  | lookup [fetch dt.entity.process_group_instance], sourceField:dt.entity.process_group_instance, lookupField:id\n  | fields ts, dt.entity.process_group_instance, dt.entity.host = lookup.belongs_to[dt.entity.host]\n  | lookup [fetch dt.entity.process_group_instance], sourceField:dt.entity.process_group_instance, lookupField:id\n  | fieldsAdd cpusum = arraySum(ts)\n  | summarize cpuHostSum =sum(cpusum), by:{dt.entity.host}], // Remove the toString() as it will break the maths later\n  sourceField:dt.entity.host, lookupField:dt.entity.host\n\n  \n| fieldsAdd carbon_per_process = (if(isNull(cpu_sum),0,else:cpu_sum)/lookup.cpuHostSum) * carbon_per_host\n\n| fields dt.entity.host,dt.entity.process_group, dt.entity.process_group_instance, \n  dt.entity.process_group_instance.name = entity.name, carbon_per_process\n| sort carbon_per_process desc \n| limit 100"}},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"vertical","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","categoryAxis":"dt.entity.process_group_instance.name","valueAxis":["carbon_per_process"],"categoryAxisLabel":"dt.entity.process_group_instance.name","valueAxisLabel":"carbon_per_process","tooltipVariant":"single"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle","xAxisScaling":"analyzedTimeframe"},"singleValue":{"showLabel":true,"label":"error","prefixIcon":"","recordField":"error","autoscale":true,"alignment":"center","trend":{"trendType":"auto","isVisible":true},"colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"firstVisibleRowIndex":0,"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"displayedFields":["dt.entity.host","dt.entity.process_group","dt.entity.process_group_instance","dt.entity.process_group_instance.name"],"dataMappings":{"value":"carbon_per_process"},"truncationMode":"middle","colorMode":"color-palette","colorPalette":"blue"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"carbon_per_process","rangeAxis":""}],"variant":"single","truncationMode":"middle","displayedFields":["dt.entity.host","dt.entity.process_group","dt.entity.process_group_instance","dt.entity.process_group_instance.name"]}},"state":"success"},"previousFilterSegments":[]}],"defaultSegments":[]}
